import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useEffect } from 'react';
import { createPortal } from 'react-dom';
import { calculatePayroll } from '../../../utils/philippineTaxCalculations';
const getDepartmentName = (department) => {
    const names = {
        front_desk: 'Front Desk',
        housekeeping: 'Housekeeping',
        food_beverage: 'Food & Beverage',
        management: 'Management',
        maintenance: 'Maintenance',
        security: 'Security',
    };
    return names[department] ?? department;
};
const PayrollEditModal = ({ employee, formData, onFieldChange, onClose, onSave, }) => {
    useEffect(() => {
        const original = document.body.style.overflow;
        document.body.style.overflow = 'hidden';
        return () => {
            document.body.style.overflow = original;
        };
    }, []);
    const payroll = calculatePayroll(formData.basicPay, formData.allowance, formData.overtime, formData.overtimeRate);
    const statusStyles = (() => {
        switch (employee.status) {
            case 'paid':
                return {
                    banner: 'bg-emerald-50 border border-emerald-200',
                    text: 'text-emerald-700',
                    accent: 'text-emerald-600',
                    icon: '✅',
                    title: 'Payroll marked as Paid',
                    message: 'This payroll has been processed for this period.',
                };
            case 'delayed':
                return {
                    banner: 'bg-red-50 border border-red-200',
                    text: 'text-red-700',
                    accent: 'text-red-600',
                    icon: '⚠️',
                    title: 'Payroll is Delayed',
                    message: 'Review and update this payroll before releasing payment.',
                };
            case 'pending':
            default:
                return {
                    banner: 'bg-amber-50 border border-amber-200',
                    text: 'text-amber-700',
                    accent: 'text-amber-600',
                    icon: '⏳',
                    title: 'Payroll is Pending',
                    message: 'Adjust the values below before final approval.',
                };
        }
    })();
    return createPortal(_jsxs("div", { className: "fixed inset-0 z-[1000] flex items-center justify-center", role: "dialog", "aria-modal": "true", children: [_jsx("div", { className: "fixed inset-0 transition-opacity duration-200 bg-black/45 backdrop-blur-lg", onClick: onClose, "aria-label": "Close overlay" }), _jsxs("div", { className: "relative z-10 w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-3xl bg-white/95 shadow-2xl ring-1 ring-black/5", children: [_jsxs("div", { className: "relative px-6 pt-6 pb-5 bg-white border-b border-gray-100 rounded-t-3xl", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { className: "flex items-center gap-4", children: [_jsx("div", { className: "flex items-center justify-center w-12 h-12 text-white rounded-full shadow-sm bg-emerald-600", children: _jsxs("svg", { className: "w-5 h-5", viewBox: "0 0 24 24", fill: "currentColor", stroke: "none", children: [_jsx("path", { d: "M9 2h6l4 4v12a2 2 0 01-2 2H7a2 2 0 01-2-2V4a2 2 0 012-2z" }), _jsx("path", { d: "M9 11h6M9 15h4", stroke: "rgba(255,255,255,0.9)", strokeWidth: "1", fill: "none" })] }) }), _jsxs("div", { className: "flex flex-col", children: [_jsx("h2", { className: "text-lg font-semibold text-emerald-700 md:text-2xl", children: "Edit Payroll" }), _jsxs("p", { className: "mt-1 text-sm text-gray-500", children: [employee.name, " \u2022 ", employee.employeeId] })] })] }), _jsx("div", { "aria-hidden": true })] }), _jsx("button", { onClick: onClose, "aria-label": "Close", className: "absolute flex items-center justify-center rounded-md top-4 right-4 w-9 h-9 text-emerald-700 bg-emerald-50 ring-1 ring-emerald-100", children: _jsx("svg", { className: "w-4 h-4", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M6 18L18 6M6 6l12 12" }) }) })] }), _jsxs("div", { className: "p-6 overflow-y-auto max-h-[calc(90vh-160px)] space-y-6", children: [_jsx("div", { className: `p-4 rounded-xl ${statusStyles.banner} ring-1 ring-black/5`, children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: `text-2xl ${statusStyles.accent}`, children: statusStyles.icon }), _jsxs("div", { children: [_jsx("h3", { className: `text-base font-semibold ${statusStyles.text}`, children: statusStyles.title }), statusStyles.message && (_jsx("p", { className: `text-sm ${statusStyles.accent}`, children: statusStyles.message }))] })] }), _jsxs("div", { className: "text-right", children: [_jsx("p", { className: "text-xs font-medium text-gray-500", children: "Current Net Pay" }), _jsxs("p", { className: "text-2xl font-bold text-gray-900", children: ["\u20B1", payroll.netPay.toLocaleString()] })] })] }) }), _jsxs("div", { className: "grid grid-cols-1 gap-6 md:grid-cols-2", children: [_jsxs("div", { className: "p-5 bg-white rounded-2xl ring-1 ring-black/5", children: [_jsx("h4", { className: "mb-3 text-lg font-semibold text-gray-900", children: "Employee Information" }), _jsxs("div", { className: "space-y-2 text-sm text-gray-700", children: [_jsxs("p", { children: [_jsx("span", { className: "font-medium text-gray-600", children: "Name:" }), " ", employee.name] }), _jsxs("p", { children: [_jsx("span", { className: "font-medium text-gray-600", children: "Employee ID:" }), " ", employee.employeeId] }), _jsxs("p", { children: [_jsx("span", { className: "font-medium text-gray-600", children: "Position:" }), " ", employee.position] }), _jsxs("p", { children: [_jsx("span", { className: "font-medium text-gray-600", children: "Department:" }), " ", getDepartmentName(employee.department)] })] })] }), _jsxs("div", { className: "p-5 bg-white rounded-2xl ring-1 ring-black/5", children: [_jsx("h4", { className: "mb-3 text-lg font-semibold text-gray-900", children: "Payroll Details" }), _jsxs("div", { className: "space-y-2 text-sm text-gray-700", children: [_jsxs("p", { children: [_jsx("span", { className: "font-medium text-gray-600", children: "Pay Period:" }), " ", employee.payPeriod] }), _jsxs("p", { children: [_jsx("span", { className: "font-medium text-gray-600", children: "Status:" }), ' ', _jsx("span", { className: "capitalize", children: employee.status })] }), _jsxs("p", { children: [_jsx("span", { className: "font-medium text-gray-600", children: "Basic Pay (current):" }), " \u20B1", formData.basicPay.toLocaleString()] }), _jsxs("p", { children: [_jsx("span", { className: "font-medium text-gray-600", children: "Allowance (current):" }), " \u20B1", formData.allowance.toLocaleString()] })] })] })] }), _jsxs("div", { className: "grid grid-cols-1 gap-6 md:grid-cols-2", children: [_jsxs("div", { className: "p-5 bg-white rounded-2xl ring-1 ring-black/5", children: [_jsx("h4", { className: "mb-3 text-lg font-semibold text-gray-900", children: "Adjust Payroll Values" }), _jsxs("div", { className: "space-y-4", children: [_jsxs("div", { className: "space-y-1", children: [_jsx("label", { className: "text-sm font-medium text-gray-700", children: "Basic Pay" }), _jsx("input", { type: "number", value: formData.basicPay, onChange: (e) => onFieldChange('basicPay', parseFloat(e.target.value) || 0), className: "w-full px-3 py-2 text-sm font-semibold text-right border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#82A33D]/50 focus:border-[#82A33D]" })] }), _jsxs("div", { className: "space-y-1", children: [_jsx("label", { className: "text-sm font-medium text-gray-700", children: "Allowance" }), _jsx("input", { type: "number", value: formData.allowance, onChange: (e) => onFieldChange('allowance', parseFloat(e.target.value) || 0), className: "w-full px-3 py-2 text-sm font-semibold text-right border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#82A33D]/50 focus:border-[#82A33D]" })] }), _jsxs("div", { className: "grid items-end grid-cols-2 gap-3", children: [_jsxs("div", { className: "space-y-1", children: [_jsx("label", { className: "text-sm font-medium text-gray-700", children: "Overtime Hours" }), _jsx("input", { type: "number", value: formData.overtime, onChange: (e) => onFieldChange('overtime', parseFloat(e.target.value) || 0), className: "w-full px-3 py-2 text-sm font-semibold text-right border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#82A33D]/50 focus:border-[#82A33D]" })] }), _jsxs("div", { className: "space-y-1", children: [_jsx("label", { className: "text-sm font-medium text-gray-700", children: "Overtime Rate" }), _jsx("input", { type: "number", value: formData.overtimeRate, onChange: (e) => onFieldChange('overtimeRate', parseFloat(e.target.value) || 0), className: "w-full px-3 py-2 text-sm font-semibold text-right border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#82A33D]/50 focus:border-[#82A33D]" })] })] })] })] }), _jsxs("div", { className: "p-5 bg-white rounded-2xl ring-1 ring-black/5", children: [_jsx("h4", { className: "mb-3 text-lg font-semibold text-gray-900", children: "Updated Payroll Breakdown" }), _jsx("div", { className: "mb-4 text-sm text-gray-600", children: _jsxs("p", { children: ["You are editing the payroll for ", _jsx("span", { className: "font-semibold", children: employee.name }), " in", ' ', _jsx("span", { className: "font-semibold", children: getDepartmentName(employee.department) }), " for the period", ' ', _jsx("span", { className: "font-semibold", children: employee.payPeriod }), "."] }) }), _jsxs("div", { className: "space-y-2 text-sm", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsx("span", { className: "text-gray-600", children: "Basic Pay" }), _jsxs("span", { className: "font-semibold text-gray-900", children: ["\u20B1", payroll.basicPay.toLocaleString()] })] }), _jsxs("div", { className: "flex items-center justify-between", children: [_jsx("span", { className: "text-gray-600", children: "Allowance" }), _jsxs("span", { className: "font-semibold text-gray-900", children: ["\u20B1", payroll.allowance.toLocaleString()] })] }), _jsxs("div", { className: "flex items-center justify-between", children: [_jsx("span", { className: "text-gray-600", children: "Overtime Pay" }), _jsxs("span", { className: "font-semibold text-gray-900", children: ["\u20B1", payroll.overtimePay.toLocaleString()] })] }), _jsx("div", { className: "pt-2 mt-2 border-t border-gray-200" }), _jsxs("div", { className: "flex items-center justify-between", children: [_jsx("span", { className: "text-gray-600", children: "Gross Pay" }), _jsxs("span", { className: "font-semibold text-gray-900", children: ["\u20B1", payroll.grossPay.toLocaleString()] })] }), _jsxs("div", { className: "flex items-center justify-between", children: [_jsx("span", { className: "text-gray-600", children: "Total Deductions" }), _jsxs("span", { className: "font-semibold text-red-700", children: ["-\u20B1", payroll.totalDeductions.toLocaleString()] })] }), _jsxs("div", { className: "flex items-center justify-between mt-2", children: [_jsx("span", { className: "text-xs font-semibold tracking-wide text-gray-500 uppercase", children: "Net Pay" }), _jsxs("span", { className: "px-3 py-1 text-sm font-extrabold text-[#82A33D] bg-[#82A33D]/10 rounded-lg", children: ["\u20B1", payroll.netPay.toLocaleString()] })] })] })] })] }), _jsxs("div", { className: "p-4 text-xs text-gray-500 bg-white rounded-2xl ring-1 ring-black/5", children: ["Changes made here will update this employee's payroll breakdown once you click ", _jsx("span", { className: "font-semibold", children: "Save Changes" }), "."] })] }), _jsxs("div", { className: "flex justify-end gap-3 px-6 py-4 border-t border-gray-100 bg-gray-50/80", children: [_jsx("button", { type: "button", onClick: onClose, className: "px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-100", children: "Cancel" }), _jsxs("button", { type: "button", onClick: onSave, className: "inline-flex items-center gap-2 px-4 py-2 text-sm font-bold text-white rounded-lg shadow-md bg-gradient-to-r from-[#82A33D] to-emerald-600 hover:from-[#6d8735] hover:to-emerald-700", children: [_jsx("svg", { className: "w-4 h-4", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: _jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M5 13l4 4L19 7" }) }), "Save Changes"] })] })] })] }), document.body);
};
export default PayrollEditModal;
